#!/bin/sh

# generate numbers
awk 'BEGIN {for (j = 1; j <= 100; j++) print j}' | \
	# add unary count at the end of the line
	while IFS='$\n' read -r LINE; do
		echo "${LINE}$(yes "_" | head -n "${LINE}" | tr '\n' ' ' | sed 's/ //g')"
	done | \

	# add buzz after all multiples of 5
	sed 's/^\([0-9]*[50]\)/\1Buzz/g' | \

	# sum up all digits
	sed 's/[0369]//g' | \
	sed ':x ; s/^\([0-9]*\)11/\12/g ; s/^\([0-9]*\)12/\1/g ; s/^\([0-9]*\)14/\15/g ; s/^\([0-9]*\)15/\1/g ; s/^\([0-9]*\)17/\18/g ; s/^\([0-9]*\)18/\1/g ; s/^\([0-9]*\)21/\1/g ; s/^\([0-9]*\)22/\14/g ; s/^\([0-9]*\)24/\1/g ; s/^\([0-9]*\)25/\17/g ; s/^\([0-9]*\)27/\1/g ; s/^\([0-9]*\)28/\11/g ; s/^\([0-9]*\)31/\14/g ; s/^\([0-9]*\)32/\15/g ; s/^\([0-9]*\)34/\17/g ; s/^\([0-9]*\)35/\18/g ; s/^\([0-9]*\)37/\11/g ; s/^\([0-9]*\)38/\11/g ; s/^\([0-9]*\)41/\15/g ; s/^\([0-9]*\)42/\1/g ; s/^\([0-9]*\)44/\18/g ; s/^\([0-9]*\)45/\1/g ; s/^\([0-9]*\)47/\11/g ; s/^\([0-9]*\)48/\12/g ; s/^\([0-9]*\)51/\1/g ; s/^\([0-9]*\)52/\17/g ; s/^\([0-9]*\)54/\1/g ; s/^\([0-9]*\)55/\11/g ; s/^\([0-9]*\)57/\12/g ; s/^\([0-9]*\)58/\1/g ; s/^\([0-9]*\)61/\17/g ; s/^\([0-9]*\)62/\18/g ; s/^\([0-9]*\)64/\11/g ; s/^\([0-9]*\)65/\11/g ; s/^\([0-9]*\)67/\1/g ; s/^\([0-9]*\)68/\14/g ; s/^\([0-9]*\)71/\18/g ; s/^\([0-9]*\)72/\1/g ; s/^\([0-9]*\)74/\11/g ; s/^\([0-9]*\)75/\12/g ; s/^\([0-9]*\)77/\14/g ; s/^\([0-9]*\)78/\15/g ; s/^\([0-9]*\)81/\1/g ; s/^\([0-9]*\)82/\11/g ; s/^\([0-9]*\)84/\12/g ; s/^\([0-9]*\)85/\1/g ; s/^\([0-9]*\)87/\15/g ; s/^\([0-9]*\)88/\1/g ; s/^\([0-9]*\)91/\11/g ; s/^\([0-9]*\)92/\11/g ; s/^\([0-9]*\)94/\1/g ; s/^\([0-9]*\)95/\14/g ; s/^\([0-9]*\)97/\1/g ; s/^\([0-9]*\)98/\17/g ; tx' | \

	# replace multiples of 3 with fizz
	sed 's/^[369]/Fizz/g' | \

	# strip underscores from fizzes and buzzes
	sed 's/\(Fizz\|Buzz\)_*/\1/g' | \

	# strip remaining numbers
	sed 's/[0-9]//g' | \

	# reconvert numbers
	awk '/_/ { print length } !/_/ { print $0 }' | \

	# for debugging
	cat -

